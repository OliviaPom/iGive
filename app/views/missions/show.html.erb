<div class="container">

    <% if @mission.photos.any? %>
     <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
       <div class="carousel-inner" role="listbox">
        <div class="carousel-item active" style="background-image: url(<%= cl_image_path @mission.photos[0].key, class: "d-block w-100" %>), linear-gradient(rgba(1,1,1,0.2), rgba(0,0,0,0.2))">
         <h2 class="carousel-text"></h2>
         <div class="carousel-caption d-none d-md-block">
         </div>
        </div>
        <% @mission.photos.drop(1).each do | photo | %>
       <div class="carousel-item" style="background-image: url(<%= cl_image_path photo.key, class: "d-block w-100" %>), linear-gradient(rgba(1,1,1,0.2), rgba(0,0,0,0.2))">
        <div class="carousel-caption d-none d-md-block">
        </div>
       </div>
       <% end %>
    </div>
    <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
          <span class="carousel-control-prev-icon" aria-hidden="true"></span>
          <span class="sr-only">Previous</span>
        </a>
    <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
          <span class="carousel-control-next-icon" aria-hidden="true"></span>
          <span class="sr-only">Next</span>
        </a>
  </div>
  <% end %>
</div>

<div class="container">
<h1 class="my-4">The Mission </h1>
  <div class="d-flex flex-row bd-highlight mb-3">
     <div class="p-2 bd-highlight">
      <div class="card mb-3">
        <div class="card-body">
          <ul class="list-group">
          <table class="table table-borderless table-sm">
              <tr>
                <td>Title:</td>
                <td><span class="text-secondary"><%= @mission.title %></span></td>
              </tr>
              <tr>
                <td>Start Date:</td>
                <td><span class="text-secondary"><%= @mission.start_date.strftime('%d/%m/%Y') %></span></td>
              </tr>
              <tr>
                <td>Description:</td>
                <td><span class="text-secondary"><%= @mission.description %></span></td>
              </tr>
              <tr>
                <td>Address:</td>
                <td><span class="text-secondary"><%= @mission.address %></span></td>
              </tr>
               <tr>
                <td>Volunteers Needed: </td><% mission = @mission %>
                <td><span><%= render "shared/icon_count", mission: mission %></span></td>
              </tr>
          </table>
        </ul>
       </div>
      </div>
     </div>
   </div>
<% if current_user.charity.blank? && !@mission.users.include?(current_user)%>
  <%= simple_form_for [@mission, Booking.new] do |f| %>
    <%= f.button :submit, 'Apply Now', class:"btn btn-sm btn-primary" %>
  <% end %>
<% elsif @mission.users.include?(current_user) %>
  <%= link_to 'See Your Mission Application', dashboard_path, class: "btn btn-rounded-sm btn-success"%>
<% end %>
<%= link_to 'Back to missions', missions_path, class: "btn btn-rounded-sm btn-info"%>

 <div class="card my-4">
    <div class="card-header">
      <a class="card-link" data-toggle="collapse" href="#collapseOne">
        <i class="fa"></i> More info. about <%= @charity.name%>
      </a>
    </div>
    <div id="collapseOne" class="collapse">
      <div class="card-body">
        <ul class="list-group">
          <table class="table table-borderless table-sm">
              <tr>
                <td>Description:</td>
                <td><span class="text-secondary"><%= @charity.description %></span></td>
              </tr>
              <tr>
                <td>Phone Number:</td>
                <td><span class="text-secondary"><%= @charity.phone_number%></span></td>
              </tr>
              <tr>
                <td>Website:</td>
                <td><span class="text-secondary"><%= @charity.website %></span></td>
              </tr>
          </table>
        </ul>
      </div>
    </div>
  </div>
  <p><strong>Location</strong></p>

      <div id="map" style="width: 100%; height: 50vh;"
           data-markers="<%= @markers.to_json %>"
           data-mapbox-api-key="<%= ENV['MAPBOX_API_KEY'] %>">
      </div>
<!-- End of container -->
</div>
